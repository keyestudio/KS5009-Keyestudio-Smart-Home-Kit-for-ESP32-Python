# **ESP32 IoT Smart Home Kit for MicroPython**

![](media/1163e9f8c90f23b7a404791f9c4bd3f7.png)

## 1.Description

As the rapid development of the Internet grows, various intelligent devices are gradually integrated into our daily life. For example, we can use RFID to open the door. In addition, the kitchen is equipped with a gas detection alarm, which alerts people to the danger when dangerous gas and large smoke are detected. When it detects rain, it can automatically collect clothes and close windows. All kinds of electrical equipment can be controlled by mobile phone, control lights, fans, air conditioning and so on.

In this connection, we seek to launch this smart home product with ESP32 control, which has a host of sensors and modules as well as networking function, making the relevant knowledge of the Internet more accessible to you.

## 2.Features

Elegant appearance

A host of sensor modules

Mobile phone APP network control

Morse password door

It can automatically close windows

RFID function

C language and MicroPython

## 3.Kit list

| \# | Picture                                                                                                                                                             | Name                                  | QTY               |
|----|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|-------------------|
| 1  | ![未标题-2](media/b560f7be0ce2c2d7534576d950528260.jpeg)                                                                                                            | Wooden Board                          | 1                 |
| 2  | ![未标题-1](media/74a3a377c2bcfed83365320e364fd482.jpeg)                                                                                                            |  Acrylic Board                        | 1                 |
| 3  | ![\_DSC5923](media/1a7d4155e125e37cd0dcb90dbc91ec5c.jpeg)                                                                                                           | ESP32 PLUS Development Board          | 1                 |
| 4  |  ![16](media/3a6b4ad25421aaa86fa120bea64cf6eb.png)                                                                                                                  |  6812 RGB Module                      | 1                 |
| 5  | ![17](media/2b0ca5300e76049aca5cc4eff15633f0.png)                                                                                                                   | Analog Gas Sensor                     | 1                 |
| 6  | ![4](media/1f9f1fc55c50387418fbca20eb2ada99.png)                                                                                                                    | Button Module                         | 2                 |
| 7  | ![RFID 新(1)](media/0016b6f83c18cda6804a1ef58c4300b2.png)                                                                                                           | RFID Module                           | 1                 |
| 8  | ![6](media/b5c96bec0fabc393395428791ae81358.png)                                                                                                                    | Passive Buzzer Module                 | 1                 |
| 9  | ![25(1)](media/a572bcde7a5e3bf01d273b3d9a024701.png)                                                                                                                | 130 Motor                             | 1                 |
| 10 | ![14](media/90bec429f8b84d8446c5107a86c0a0da.png)                                                                                                                   | Steam Sensor                          | 1                 |
| 11 | ![1](media/046b44ce1caf1608d8bacec5b127ba0d.png)                                                                                                                    | XHT11 Temperature and Humidity Sensor | 1                 |
| 12 | ![15](media/63b47a2f4ef533a41a14d65d490cad06.png)                                                                                                                   | PIR Motion Sensor                     | 1                 |
| 13 | ![13](media/80b8e979df120788f2c56ffa0801e974.png)                                                                                                                   | Yellow LED Module                     | 1                 |
| 14 | ![IMG_256](media/78bcbf50389079a2b773538794e925cd.png)                                                                                                              | Servo                                 | 2                 |
| 15 | ![IMG_256](media/9e333cb91eb0e585e50e21c6eb31aaca.png)                                                                                                              | I2C1602 LCD Module                    | 1                 |
| 16 | ![C:\\Users\\Admin\\Desktop\\KS0078 旅行房车机器人安装步骤\\模块\\3pin 黑红黄 150mm（1）.png3pin 黑红黄 150mm（1）](media/a6f94cd448d58a53f41b2a1fa2204863.png)     | 3P F-F 150 mm Dupont Wire             | 5                 |
| 17 | ![C:\\Users\\Admin\\Desktop\\KS0078 旅行房车机器人安装步骤\\模块\\3pin 黑红黄 200mm（1）.png3pin 黑红黄 200mm（1）](media/6fc873ea0e2d30ef6c65c48192777b2c.png)     | 3P F-F 200 mm Dupont Wire             | 4                 |
| 18 | ![23](media/8d8d7ecea527ea96266c5a30a23adc49.png)                                                                                                                   | F-F 200 mm /40P/2.54 Wires            | 0.1 （4 strands） |
| 19 | ![C:\\Users\\Admin\\Desktop\\KS0078 旅行房车机器人安装步骤\\模块\\4pin 黑红蓝绿 200mm（1）.png4pin 黑红蓝绿 200mm（1）](media/4de60c3b32470ba75de2c6d2b39dfabb.png) | 4P F-F 200 mm Splicing Dupont Wire    | 2                 |
| 20 | ![](media/b05fb368afcc7f64143fd15972aa1fcc.png)                                                                                                                     | M1.4\*6MM Round Head Screws           | 10                |
| 21 | ![](media/2921490c73e7ec456e68d03f26cd638d.png)                                                                                                                     | M3 Nickle-plated Nut(self-locking)    | 5                 |
| 22 | ![](media/90f262e52991756983f29416b65889de.png)                                                                                                                     | M4\*8MM Round Head Screws             | 24                |
| 23 | ![](media/de8991dc2b94e7a9a01e24239cf77500.png)                                                                                                                     | M3\*6MM Round Head Screws             | 9                 |
| 24 | ![](media/90f262e52991756983f29416b65889de.png)                                                                                                                     | M3\*10MM Round Head Screws            | 5                 |
| 25 | ![](media/90f262e52991756983f29416b65889de.png)                                                                                                                     | M2\*12MM Round Head Screws            | 5                 |
| 26 | ![](media/40828578b370119a7a5c40dcc412f9c6.png)                                                                                                                     | M4 Nickle-plated Nut                  | 24                |
| 27 | ![](media/40828578b370119a7a5c40dcc412f9c6.png)                                                                                                                     | M3 Nickle-plated Nut                  | 7                 |
| 28 | ![](media/40828578b370119a7a5c40dcc412f9c6.png)                                                                                                                     | M2 Nickle-plated Nut                  | 6                 |
| 29 | ![](media/2991c80d0f141474a234a1b915866506.png)                                                                                                                     | M3\*8MM Flat Head Screws              | 3                 |
| 30 | ![C:\\Users\\Admin\\Desktop\\模块\\十字套筒.jpg十字套筒](media/e8e1c04d2c03b995842b0bd92e2fdf72.jpeg)                                                               | Cross Wrench                          | 1                 |
| 31 | ![](media/f353b46e6c2c0597c3268d5aa137fd99.png)                                                                                                                     | 3.0\*40MM Screwdriver                 | 1                 |
| 32 | ![螺丝钉](media/aa12dd0fe16e3f122e1822f671b3c0c7.png)                                                                                                               | 2.0\*40MM Screwdriver                 | 1                 |
| 33 | ![](media/71338bc1f531d68fa7747582b8f2b073.png)                                                                                                                     | M3\*10MM Dual-pass Copper Pillar      | 4                 |
| 34 | ![](media/a2785e36ab41cea44f41ddf2d87c8ead.png)                                                                                                                     | USB Cable                             | 1                 |
| 35 | ![](media/119770f24627eed3c13c3008eb926888.png)                                                                                                                     | 6-Slot AA Battery Holder              | 1                 |
| 36 | ![](media/90f262e52991756983f29416b65889de.png)                                                                                                                     | M3\*12MM Round Head Screws            | 4                 |
| 37 | ![门卡2](media/ac4d8bcad35658ce6ec738d4aaa555c7.png)                                                                                                                | White Card                            | 1                 |
| 38 | ![3 (2)](media/cfc5265d05b7b1cd89f9853bca223fb3.png)                                                                                                                | ABS RFID Key                          | 1                 |

## 4.get starter with thonny

#### Open the Thonny Package

Please refer to the folder shown below:

![](media/29fa7a9563dec2dddbfc7ed79d197380.png)

#### Thonny [Interface](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.8.0/resultui/html/index.html#/javascript:;)

Open the Thonny

![](media/d753621b40cd7405ce034e93e0f5678a.png)

Main interface functions:

![](media/d41b79772c9846fd8bf295c8451f8321.png)

![](media/3d04fe6893ca104e4e593a0786cb3799.png)

#### Select ESP32 Development Environment

Click Python.exe，then select Configure interpreter

![](media/30d66dba96cfabbe2bd3b6c858564ef2.png)

Select MicroPython(ESP32) from the Interpreter interface

![](media/5f92c4dd24223cf49d6da075aa53307f.png)

#### Installing Firmware

Download link：<https://micropython.org/download/esp32/>

Choose to download version V1.17

![](media/4f1f3b0568c3ae2ca3288431df340184.png)

Of course, we also provide the downloaded firmware, as shown below.

![](media/150da4adbcbf76f47793254a2ae56967.png)

Burn microPython firmware

Connect the smart home to your computer with a USB.

Click Install or update firmware

![](media/9b8470fee22b3a6aa4ac21d1e1d10eda.png)

Select Port

![](media/d3bff3f1b25076733717273e94616088.png)

Click Browser to find the the downloaded version V1.17 firmware

![](media/ad4cfc202f014101ddd9f5373773635f.png)

![](media/aef61c4411d53f83685ad570c7d3a075.png)

Click install

![](media/507ff0c04761a509f729a8c4e88e4b27.png)

Choose Port or WebREPL as the driver of ESP32 mainboard CH340(COM)

![](media/c1c4ae83635b2c0186b1985aeef844ae.png)

![](media/19514aef3fdd86fb2c033c6441d8ff6e.png)

The ESP32 environment has been installed.

Thonny interface

![](media/c42ed7549ff7ff1f7deabd64710cb98e.png)

## 5.How to install the smart home

| Step 1                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|    Components Required                                                                                                                                                                                                                | ![ 2. 2](media/8dd604409369919ccf6f88ce6b4f8ef4.png)       |
|   Installation Diagram                                                                                                                                                                                                                | ![ 2_1. 2_1](media/5635e47e50d2d3c59396f0493248fbe1.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 2_2. 2_2](media/3c6f079bf7c6d4b6467d75683c2ab6e0.png)   |
| Step 2                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 3. 3](media/40193f8b74566b51329f60c7af843380.png)       |
|   Installation Diagram                                                                                                                                                                                                                | ![ 3_1. 3_1](media/deb26849635d49c3f6a3d650d335e1ba.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 3_2. 3_2](media/1dd06d0e20d6e82c3d40de86499595ec.png)   |
| Step 3                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 1. 1](media/70dde8f4791ac31969167ec98a71c9ff.png)       |
|  Installation （Battery holder wire installs downward）                                                                                                                                                                               | ![ 1_1. 1_1](media/f99d8208a13cb6ec7b37d92ea6bf44d4.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 1_2. 1_2](media/3e41a27e6450b4b465ce6adf7442e981.png)   |
| Step 4                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 2_3. 2_3](media/dc3d7d2ad06a95ff0073cca27257d8ba.png)   |
|   Installation Diagram                                                                                                                                                                                                                | ![ 2_4. 2_4](media/89102eccb6e6074de12c1887f869d710.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 2_5. 2_5](media/3cb7b1cad3e2d2f4c4b5444d9d660c7e.png)   |
| Step 5                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 3_3. 3_3](media/77c19fec4a9f2739bc1095e68e619e7c.png)   |
|      Step 1                                                                                                                                                                                                                           | ![ 3_4. 3_4](media/4e0d6c06490d59a969ab4991098918e1.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 3_5. 3_5](media/71080dc63e65195e7dc28d94f3041319.png)   |
| Step 6                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 3_6. 3_6](media/d4f07269d100e0f46851252e28ba8383.png)   |
| Installation （Don’t tighten the self-locking nuts ）                                                                                                                                                                                 | ![ 3_7. 3_7](media/553ac0654da4c14ad9b958ac16c46ccd.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 3_8. 3_8](media/60e168e21936ccdd39883ec5259a5dcf.png)   |
| Step 7                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 3_9. 3_9](media/4842582f892bcb0ab270554ca1487c42.png)   |
| Adjust the angle of the servo before installation                                                                                                                                                                                     | We need to adjust the servo of the window to 0 degree before installation.  Please open and burn it to the motherboard, as shown below ![](media/fef3ff6ce0bba19df94bb5cbac961c8c.png)                              |
| Installation (As shown in the picture)                                                                                                                                                                                                | ![ 3_10. 3_10](media/aa95521f86389ec884e71c5dc41fee57.png) |
|   Prototype                                                                                                                                                                                                                           | ![ 3_11. 3_11](media/adfb7abbafd97f2eaf73ee05e6ef74ec.png) |
| Step 8                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 4. 4](media/d2a9dbb7352038e6c8d06037d8479849.png)       |
|   Installation Diagram                                                                                                                                                                                                                | ![ 4_1. 4_1](media/56e79d6d0d0bbe904516a0dff5e0b065.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 4_2. 4_2](media/4ded3da1546a1a96288a013fe3b50cd6.png)   |
| Step 9                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 4_3. 4_3](media/3615bf486cb4295bf7c35119a2cb531c.png)   |
|   Installation Diagram                                                                                                                                                                                                                | ![ 4_4. 4_4](media/8cc78358bed8e02d11207bb843c37294.png)   |
|   Prototype                                                                                                                                                                                                                           | ![新智能家居_空白视图 4_5](media/58861409694aa6c85759c7a587ef991e.png)                                                                                                                                              |
| Step 10                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 4_6. 4_6](media/be5af4990413c71bbecf8ceee1e36890.png)   |
|   Installation Diagram                                                                                                                                                                                                                | ![新智能家居_空白视图 4_7](media/917885be60d62d6d684bfae2eda9fcda.png)                                                                                                                                              |
|   Prototype                                                                                                                                                                                                                           | ![ 4_8. 4_8](media/3b619925112b0df796c70eaedb638e2e.png)   |
| Step 11                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5. 5](media/61a63240fef3eeab555697282a45e5aa.png)       |
|   Installation Diagram                                                                                                                                                                                                                | ![新智能家居_空白视图 5_1](media/28962cc5cc630fdcde317015db012493.png)                                                                                                                                              |
|   Prototype                                                                                                                                                                                                                           | ![ 5_2. 5_2](media/0adad38a8057430d3079a1a8b83b6aa0.png)   |
| Step 12                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_3. 5_3](media/03a042d71bffc005eb7205fbad6160fe.png)   |
|   Installation Diagram                                                                                                                                                                                                                | ![新智能家居_空白视图 5_4](media/1b66b8276b5bf2ddb2c0250b7747a680.png)                                                                                                                                              |
|   Prototype                                                                                                                                                                                                                           | ![新智能家居_空白视图 5_5](media/ab966ba502dcd28ba54465d397ced1fe.png)                                                                                                                                              |
| Step 13                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_6. 5_6](media/99e6ac3da48de02825ea132ce16f0d65.png)   |
|   Installation Diagram                                                                                                                                                                                                                | ![ 5_7. 5_7](media/6de404a9bf8bcf588d797bfc8aad25c3.png)   |
|   Prototype                                                                                                                                                                                                                           | ![ 5_8. 5_8](media/9e70c40c583b46f90285fd8c23005cd5.png)   |
| Step 14                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_9. 5_9](media/e9e83216afd5f55d907f3814e434bdff.png)   |
|   Installation Diagram                                                                                                                                                                                                                | ![新智能家居_空白视图 5_10](media/a918ecc2c9abb3cbbce1fe32b45a7aae.png)                                                                                                                                             |
|   Prototype                                                                                                                                                                                                                           | ![ 5_11. 5_11](media/5d6482b761491738bbce0362dbef31e9.png) |
| Step 15                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_12. 5_12](media/2c4a8d81449ce6c6a294c9535bd7244b.png) |
|   Installation Diagram                                                                                                                                                                                                                | ![ 5_13. 5_13](media/4db291f9ac3ed41956f7c7185fa38f64.png) |
|   Prototype                                                                                                                                                                                                                           | ![ 5_14. 5_14](media/988ca4ff3040d709012588dcb3b2c2d5.png) |
| Step 16                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_15. 5_15](media/9c4c1c7fb8609386670e6427b0e02696.png) |
|   Installation Diagram                                                                                                                                                                                                                | ![ 5_16. 5_16](media/5a3f843578cc59e4023481bff69e4189.png) |
|   Prototype                                                                                                                                                                                                                           | ![ 5_17. 5_17](media/718bb1c9b50fb5ac328ab74a1114c0f7.png) |
| Step 17                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_18. 5_18](media/d5d400670d0d36caa3a08cb59e0a8892.png) |
|   Installation Diagram                                                                                                                                                                                                                | ![新智能家居_空白视图 5_19](media/2a8634f2a50fb7bf1ef20e1949378e3c.png)                                                                                                                                             |
|   Prototype                                                                                                                                                                                                                           | ![ 5_20. 5_20](media/df39c9789513ea5e13043cfaa1e687c3.png) |
| Step 18                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_21](media/f9ae11d160ca4fa1ab7a517bf538036b.png) |
|   Installation Diagram                                                                                                                                                                                                                | ![ 5_22](media/e50de39b9c9805b808933b266458eed4.png) |
|   Prototype                                                                                                                                                                                                                           | ![ 5_23. 5_23](media/effcbfa998c83525095360f7c6a19676.png) |
| 安装19                                                                                                                                                                                                                                |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![ 5_24. 5_24](media/e855c45671386c25affdfa67144fb66d.png) |
|   Installation Diagram                                                                                                                                                                                                                | ![ 5_25. 5_25](media/9637cad77c563081c78bd014920d44d8.png) |
|   Prototype                                                                                                                                                                                                                           | ![ 5_26. 5_26](media/85f68b8b0880c6834105a23c21c3ba00.png) |
| Wiring Part                                                                                                                                                                                                                           |                                                                                                                                                                                                                     |
|   Connect the temperature and humidity module to the io17 interface                                                                                                                                                                   | ![a6dee004706ed19c8e9a90e7f5476ed](media/f1b4c867461ddfda99864a869c5c95d6.png) ![963451d72b40e05b5c69efaa94f3bdf](media/b20fffd8e6d99fdea58ac47ab4b339a5.png)                                                       |
|    Connect the yellow led module to the io12 interface                                                                                                                                                                                | ![995bdfbd8679d3690b29f7928e251f3](media/dde91d35071cf121cce9819285dedf11.png) ![ee3ea811be1787fedc24f7a3cda4705](media/8f254931280578d7829b16344a9e2bda.png)                                                       |
|    Connect the steam sensor to the io34 interface                                                                                                                                                                                     | ![1e0b5dcced51b38be90d226edba446e](media/7b1a691b51febe363ab12b946db061ed.png) ![5e607c79090158d4add4aac3c9ed273](media/db35422182a8b02ed371bcecbf4640b8.png)                                                       |
|    The wiring of the fan (IN- corresponds to io18，IN+ corresponds to io19）                                                                                                                                                          | ![1e0b5dcced51b38be90d226edba446e](media/ff9321b5aeca85f076a6933f40ca0c5f.png)![53e25a3aaf1151e672ad5bf74f60727](media/8688977d33afcb5fe1542b31e5cf0259.png)                                                        |
|    Connect the PIR motion sensor to the io14 interface                                                                                                                                                                                | ![4e43ddeb1b3dc7233c66167981bad97](media/85f995f5b99f0a9b11d7619e2fe86f0f.png) ![20a935d2eb926d37d5dc38cbb20d1a1](media/6572ce6a6ddfc8bf17945fc71897d9fb.png)                                                       |
|   Connect the left button module to the io16 interface                                                                                                                                                                                | ![4e43ddeb1b3dc7233c66167981bad97](media/cb1fbcc3cc339b54763158b9a8f69cf8.png) ![2b74ef9590729e6cc51aef8de227226](media/2d579eeb0aa3a6f71f1572e1579d153f.png)                                                       |
|     Connect the right button module to the io27 interface                                                                                                                                                                             | ![5e76f27cb53cb81e2e3ff6da7232f1c](media/36c4c59096035d82c4dd865cd9d13cf5.png) ![d73806fb825f9e4e729169b56116202](media/639ac8cf0b991c7c150a6b4be8cf8e93.png)                                                       |
|    Connect the RFID module to the IIC interface                                                                                                                                                                                       | ![ca6e2ee0087f0303921b4cea1cd3ede](media/b1e8ac132e80025a0db1921d267c42e5.jpeg) ![58895cd66633759b4f1a2f462230b74](media/142fd5fdd102aa25eb3f8406e257ccaf.png)                                                      |
|     Connect the LCD1602 display to the IIC interface                                                                                                                                                                                  | ![288f8d2a36295c634680386969e647b](media/100221791e78a93f064b50a10e501e88.png) ![601fba0da28f7aef5acef9aab879e5f](media/518e6c496b5c22b7d4b0c4de40acc80e.png)                                                       |
|    Connect the 6812RGB LED to the io26 interface                                                                                                                                                                                      | ![216a8df028881a5be6533ad9a5a9824](media/32fcbd73e4b983b481e7b54b9de5e9a8.png) ![5038b5b3d54816c6ea31bbadf250fab](media/4edea8aa5ff83d17fa8cab9173760c12.png)                                                       |
|    Connect the gas sensor to the io23 interface                                                                                                                                                                                       | ![305fdd8157fd1bfb2646142ea8c29bd](media/2e0bed87005c23de310544bc18de2814.png) ![ce672f1617c9bb027d75d2d83136db6](media/ed22723361dc2dc2bc0eb6b80c36ce28.png)                                                       |
|     Connect the buzzer sensor to the io25 interface                                                                                                                                                                                   | ![eab837bdce4833e1b551034cca5550d](media/9c5beffaa46e6ed0a4df27a0bbd92366.png) ![ec41669efbb972852cb8a827becbd29](media/77e7f24ef8d39732a6ae6a9150e86243.png)                                                       |
|   Connect servo controlling windows to the io5 interface                                                                                                                                                                              | ![1462b340d9ebf0081cebc8a8ac2ee24](media/3dce3c0b762bfdadbd6edd8e358398b1.png) ![dcc0b8b023c8b2878bcc6c3107a2d3f](media/4f4c7f0ea162c7de24f1263dafad9075.png)                                                       |
|    Connect servo controlling doors to the io13 interface                                                                                                                                                                              | ![ccb5fb0ff02c3f134e3556d96b88e4b](media/c4871cda06750e30ca513a1b1e338f73.png) ![5744ae4e4fe51254a318b0d9f8a2e8f](media/c6334d6486a50808300936aef00a55e8.png)                                                       |
|     [power](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;) [wiring](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;)  |  ![0c61b8e6ecbfcfd1263c8ef19248188](media/66217ef904b5256055eb20b2f8c95678.jpeg)                                                                                                                                    |
| Step 20                                                                                                                                                                                                                               |                                                                                                                                                                                                                     |
|    Components Required                                                                                                                                                                                                                | ![新智能家居_空白视图 5_27](media/981c1d00ec6ffa26832828c3bb50cff2.png)                                                                                                                                             |
|   Installation Diagram                                                                                                                                                                                                                | ![新智能家居_空白视图 5_28](media/103f079c5a1bbdee286d00e98463fe89.png)                                                                                                                                             |
|     Prototype                                                                                                                                                                                                                         | ![新智能家居_空白视图 5_29](media/c70b59a621643bbc55f1b86e00e85702.png)                                                                                                                                             |

## 6.Projects

Please refer to the file below：

![](media/528951558fa53138c60b87e160a94d05.png)

### Project 1: Control LED

we will first learn how to control LED.

![](media/0cda68ae8719d9b6c1bb79d64160d31d.png)

1.  **Working Principle**

LED is also the light-emitting diode, which can be made into an electronic module. It will shine if we control pins to output high level, otherwise it will be off.

1.  [**Parameter**](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;)**s**

| Working voltage | DC 3\~5V |
|-----------------|----------|
| Working current | \<20mA   |
| Power           | 0.1W     |

1.  **Control Pin**

| Yellow LED | 12 |
|------------|----|

#### Project 1.1 LED Flashing

1.  **Description**

We can make the LED pin output high level and low level to make the LED flash.

1.  **Test Code**

        from machine import Pin
        import time

        led = Pin(12, Pin.OUT)# Build an LED object, connect the external LED light to pin 0, and set pin 0 to output mode
        while True:
            led.value(1)# turn on led
            time.sleep(1)# delay 1s
            led.value(0)# turn off led
            time.sleep(1)# delay 1s

1.  Open the sample code

![](media/39658e26aad2c9794bd3db9df3c70732.png)

![](media/166384572a1fa595858d933aea5af710.png)

1.  Operation and test result

Click the button

![](media/c5e28dda04f63745f59ef351025e82e8.png)

We can see that the yellow LED is flashing .

#### Project 1.2 Breathing LED

1.  **Description**

A“breathing LED”is a phenomenon where an LED's brightness smoothly changes from dark to bright and back to dark, continuing to do so and giving the illusion of an LED“breathing. However, how to control LED’s brightness?

It makes sense to take advantage of PWM. Output the number of high level and low level in unit time, the more time the high level occupies, the larger the PWM value, the brighter the LED.

![图1](media/704984700612966b997127cb9bde5c96.jpeg)

1.  **Test Code**

        import time
        from machine import Pin,PWM

        #The way that the ESP32 PWM pins output is different from traditionally controllers.
        #It can change frequency and duty cycle by configuring PWM’s parameters at the initialization stage.
        #Define GPIO 0’s output frequency as 10000Hz and its duty cycle as 0, and assign them to PWM.
        pwm =PWM(Pin(12,Pin.OUT),10000,0)

        try:
            while True: 
        #The range of duty cycle is 0-1023, so we use the first for loop to control PWM to change the duty
        #cycle value,making PWM output 0% -100%; Use the second for loop to make PWM output 100%-0%.  
                for i in range(0,1023):
                    pwm.duty(i)
                    time.sleep_ms(1)
                    
                for i in range(0,1023):
                    pwm.duty(1023-i)
                    time.sleep_ms(1)  
        except:
        #Each time PWM is used, the hardware Timer will be turned ON to cooperate it. Therefore, after each use of PWM,
        #deinit() needs to be called to turned OFF the timer. Otherwise, the PWM may fail to work next time.
            pwm.deinit()

1.  **Test Result**

Click the button

![](media/609b283e0909b5e5c14809c4ccf892ed.png)

The LED gradually gets dimmer then brighter, cyclically, like human breathe.

### Project 2: Table Lamp

1.  **Description**

The common table lamp uses LED lights and buttons, which can control the light on and off pressing the button.

1.  **Button Principle**

The button module is a digital sensor, which can only read 0 or 1. When the module is not pressed, it is in a high level state, that is, 1, when pressed, it is a low level 0.

![](media/41f565d4f355abb96e105119660e80ba.png)

1.  **Pins of the Button**

| Button 1 | 16 |
|----------|----|
| Button 2 | 27 |

#### Project 2.1 Read the Button

**1. Description**

We will work to read the status value of the button and display it on the serial monitor, so as to see it intuitively.

**2. Test Code**

        button1 = Pin(16, Pin.IN, Pin.PULL_UP)
        button2 = Pin(27, Pin.IN, Pin.PULL_UP)

        while True:
            btnVal1 = button1.value()  # Reads the value of button 1
            btnVal2 = button2.value()
            print("button1 =",btnVal1)  #Print it out in the shell
            print("button2 =",btnVal2)
            time.sleep(0.1) #delay 0.1s

**3. Test Result**

Click the run button, then you can see the status values of button1 and button 2 printed in shell. Click the button of the smart home, and you can see the change of the status values.

![](media/1b984da67c0e89a72a9601c39362567d.png)

#### Project 2.2. Table Lamp

**1. Description**

For common simple table lamp, click the button it will be opened, click it again, the lamp will be closed.

1.  **Test Code**

Calculate the clicked button times and take the remainder of 2, you can get 0 or 1 two state values.

    from machine import Pin
    import time

    button1 = Pin(16, Pin.IN, Pin.PULL_UP)
    led = Pin(12, Pin.OUT)
    count = 0

    while True:
        btnVal1 = button1.value()  # Reads the value of button 1
        #print("button1 =",btnVal1)  #Print it out in the shell
        if(btnVal1 == 0):
            time.sleep(0.01)
            while(btnVal1 == 0):
                btnVal1 = button1.value()
                if(btnVal1 == 1):
                    count = count + 1
                    print(count)
        val = count % 2
        if(val == 1):
            led.value(1)
        else:
            led.value(0)
        time.sleep(0.1) #delay 0.1s

1.  **Test Result**

The shell will print out the clicked button times, then click the button once, the LED will be on, click it again, it will be off.

![](media/1bc079eabd93cb2e8a8e15f0ab7f1367.png)

### Project 3: PIR Motion Sensor

**1. Description**

The PIR motion sensor has many application scenarios in daily life, such as automatic induction lamp of stairs, automatic induction faucet of washbasin, etc.

It is also a digital sensor like buttons, which has two state

values 0 or 1. And it will be sensed when people are moving.

![](media/c1518252606b111bfa66878a2bfcc965.png)

1.  **Control Pin**

| PIR motion sensor  |  14 |
|--------------------|-----|

#### Project 3.1 Read the PIR Motion Sensor

We will print out the value of the PIR motion sensor through the serial monitor.

1.  **Test Code**

        from machine import Pin
        import time

        PIR = Pin(14, Pin.IN)
        while True:
            value = PIR.value()
            print(value, end = " ")
            if value == 1:
                print("Some body is in this area!")
            else:
                print("No one!")
            time.sleep(0.1)

1.  **Test Result**

When you stand still in front of the sensor, the reading value is 0, move a little, it will change to 1.

![](media/f8c6be9a6ad7a6423c1fa1456f771406.png)

#### Project 3.2 PIR Motion Sensor

If someone moves in front of the sensor, the LED will light up.

1.  **Test Code**

        from machine import Pin
        import time

        PIR = Pin(14, Pin.IN)
        led = Pin(12, Pin.OUT)

        while True:
            value = PIR.value()
            print(value)
            if value == 1:
                led.value(1)# turn on led
            else:
                led.value(0)
            time.sleep(0.1)

1.  **Test Result**

Move your hand in front of the sensor, the LED will turn on. After a few seconds of immobility, the LED will turn off.

### Project 4: Play Music

**1. Description**

There is a audio power amplifier element in the car expansion board, which is as an external amplification equipment to play music.

In this project, we will work to play a piece of music by using it.

**2. Component Knowledge**

**Passive Buzzer:** The audio power amplifier (like the passive buzzer) does not have internal oscillation. When controlling, we need to input square waves of different frequencies to the positive pole of the component and ground the negative pole to control the power amplifier to chime sounds of different frequencies.

![](media/2e6fd6b7975ef84ab94eee896161347b.png)

1.  **Control Pin**

|  Passive Buzzer | 25 |
|-----------------|----|

#### Project 4.1 Play Happy Birthday

**1. Test Code**

    from machine import Pin, PWM
    from time import sleep
    buzzer = PWM(Pin(25))

    buzzer.duty(1000) 

    # Happy birthday
    buzzer.freq(294)
    sleep(0.25)
    buzzer.freq(440)
    sleep(0.25)
    buzzer.freq(392)
    sleep(0.25)
    buzzer.freq(532)
    sleep(0.25)
    buzzer.freq(494)
    sleep(0.25)
    buzzer.freq(392)
    sleep(0.25)
    buzzer.freq(440)
    sleep(0.25)
    buzzer.freq(392)
    sleep(0.25)
    buzzer.freq(587)
    sleep(0.25)
    buzzer.freq(532)
    sleep(0.25)
    buzzer.freq(392)
    sleep(0.25)
    buzzer.freq(784)
    sleep(0.25)
    buzzer.freq(659)
    sleep(0.25)
    buzzer.freq(532)
    sleep(0.25)
    buzzer.freq(494)
    sleep(0.25)
    buzzer.freq(440)
    sleep(0.25)
    buzzer.freq(698)
    sleep(0.25)
    buzzer.freq(659)
    sleep(0.25)
    buzzer.freq(532)
    sleep(0.25)
    buzzer.freq(587)
    sleep(0.25)
    buzzer.freq(532)
    sleep(0.5)
    buzzer.duty(0)

**2. Test Result**

The passive buzzer will play happy Birthday.

### Project 5: Automatic Doors and Windows

1.  **Description**

Automatic doors and windows need power device, which will become more automatic with a 180 degree servo and some sensors. Adding a raindrop sensor, you can achieve the effect of closing windows automatically when raining. If adding a RFID, we can realize the effect of swiping to open the door and so on.

1.  **Component Knowledge**

**Servo:** Servo is a position servo [driver](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;) device consists of a housing, a circuit board, a coreless motor, a gear and a position detector.

Its working principle is that the servo receives the signal sent by MCU or receiver and produces a reference signal with a period of 20ms and width of 1.5ms, then compares the acquired DC bias voltage to the voltage of the potentiometer and obtain the voltage difference output.

The IC on the circuit board judges the direction of rotation, and then drives the coreless motor to start rotation. The power is transmitted to the swing arm through the reduction gear, and the signal is sent back by the position detector to judge whether the positioning has been reached, which is suitable for those control systems that require constant angle change and can be maintained.

When the motor speed is constant, the potentiometer is driven to rotate through the cascade reduction gear, which leads that the voltage difference is 0, and the motor stops rotating. Generally, the angle range of servo rotation is 0° --180 °.

The pulse period of the control servo is 20ms, the pulse width is 0.5ms \~ 2.5ms, and the corresponding position is -90°\~ +90°. Here is an example of a 180° servo:

![图片1(17)](media/708316fde05c62113a3024e0efb0c237.jpeg)

In general, servo has three lines in brown, red and orange. The brown wire is grounded, the red one is a positive pole line and the orange one is a signal line.

![](media/35084ae289a08e35bdb8c89ceb134ba4.png)

![](media/6cbf6f177ea204f7632b872497fde010.png)

1.  **Pin**

| The servo of the window | 5  |
|-------------------------|----|
| The servo of the door   | 13 |

#### Project 5.1 Control the Door

**1. Test Code**

    from machine import Pin, PWM
    import time
    pwm = PWM(Pin(13))  
    pwm.freq(50)

    '''
    Duty cycle corresponding to the Angle
    0°----2.5%----25
    45°----5%----51.2
    90°----7.5%----77
    135°----10%----102.4
    180°----12.5%----128
    '''
    angle_0 = 25
    angle_90 = 77
    angle_180 = 128

    while True:
        pwm.duty(angle_0)
        time.sleep(1)
        pwm.duty(angle_90)
        time.sleep(1)
        pwm.duty(angle_180)
        time.sleep(1)

**2. Test Result**

The servo of the door turns with the door, back and forth

#### Project 5.2 Close the Window

1.  **Description**

We will work to use a servo and a raindrop sensor to make an device closing windows automatically when raining.

1.  **Component Knowledge**

**Raindrop Sensor:** This is an analog input module, the greater the area covered by water on the detection surface, the greater the value returned (range 0\~4096).

1.  **Test Code**

        # Import Pin, ADC and DAC modules.
        from machine import ADC,Pin,DAC,PWM
        import time
        pwm = PWM(Pin(5))  
        pwm.freq(50)

        # Turn on and configure the ADC with the range of 0-3.3V 
        adc=ADC(Pin(34))
        adc.atten(ADC.ATTN_11DB)
        adc.width(ADC.WIDTH_12BIT)

        # Read ADC value once every 0.1seconds, convert ADC value to DAC value and output it,
        # and print these data to “Shell”. 
        try:
            while True:
                adcVal=adc.read()
                dacVal=adcVal//16
                voltage = adcVal / 4095.0 * 3.3
                print("ADC Val:",adcVal,"DACVal:",dacVal,"Voltage:",voltage,"V")
                if(voltage > 0.6):
                    pwm.duty(46)
                else:
                    pwm.duty(100)
                time.sleep(0.1)
        except:
            pass

1.  **Test Result**

At first, the window opens automatically, and when you touch the raindrop sensor with your hand (which has water on the skin), the window will close.

### Project 6: Atmosphere Lamp

1.  **Description**

The atmosphere lamp of smart home is 4 SK6812RGB LEDs. RGB LED belongs to a simple luminous module, which can adjust the color to bring out the lamp effect of different colors. Furthermore, it can be widely used in buildings, bridges, roads, gardens, courtyards, floors and other fields of decorative lighting and venue layout, Christmas, Halloween, Valentine's Day, Easter, National Day as well as other festivals during the atmosphere and other scenes.

In this experiment, we will make various lighting effects.

1.  **Component Knowledge**

From the schematic diagram, we can see that these four RGB LEDs are all connected in series. In fact, no matter how many they are, we can use a pin to control a RGB LED and let it display any color. Each RGBLED is an independent pixel, composed of R, G and B colors, which can achieve 256 levels of brightness display and complete the full true color display of 16777216 colors.

What’s more, the pixel point contains a data latch signal shaping amplifier drive circuit and a signal shaping circuit, which effectively ensures the color of the pixel point light is highly consistent.

![](media/86e292d0666046b72a1e0e68adfb17e8.png)

![](media/c0df93f61c6b9272f62b1847ccfbdb10.png)

1.  **Pin**

| SK6812 | 26 |
|--------|----|

#### Project 6.1 Control SK6812

We will control SK6812 to display various lighting effects.

**1. Test Code**

    #Import Pin, neopiexl and time modules.
    from machine import Pin
    import neopixel
    import time

    #Define the number of pin and LEDs connected to neopixel.
    pin = Pin(26, Pin.OUT)
    np = neopixel.NeoPixel(pin, 4) 

    #brightness :0-255
    brightness=100                                
    colors=[[brightness,0,0],                    #red
            [0,brightness,0],                    #green
            [0,0,brightness],                    #blue
            [brightness,brightness,brightness],  #white
            [0,0,0]]                             #close

    #Nest two for loops to make the module repeatedly display five states of red, green, blue, white and OFF.    
    while True:
        for i in range(0,5):
            for j in range(0,4):
                np[j]=colors[i]
                np.write()
                time.sleep_ms(50)
            time.sleep_ms(500)
        time.sleep_ms(500)

**2. Test Result**

The atmosphere lamps of the smart home will display red,greenish blue as well as white.

#### Project 6.2 Button

1.  **Description**

There are two switch buttons to change the color of the atmosphere lamp.

1.  **Test Code**

        #Import Pin, neopiexl and time modules.
        from machine import Pin
        import neopixel
        import time

        button1 = Pin(16, Pin.IN, Pin.PULL_UP)
        button2 = Pin(27, Pin.IN, Pin.PULL_UP)
        count = 0

        #Define the number of pin and LEDs connected to neopixel.
        pin = Pin(26, Pin.OUT)
        np = neopixel.NeoPixel(pin, 4) 

        #brightness :0-255
        brightness=100                                
        colors=[[0,0,0],
                [brightness,0,0],                    #red
                [0,brightness,0],                    #green
                [0,0,brightness],                    #blue
                [brightness,brightness,brightness]  #white
                ]                             #close

        def func_color(val):
            for j in range(0,4):
                np[j]=colors[val]
                np.write()
                time.sleep_ms(50)
                
        #Nest two for loops to make the module repeatedly display five states of red, green, blue, white and OFF.    
        while True:
            btnVal1 = button1.value()  # Reads the value of button 1
            #print("button1 =",btnVal1)  #Print it out in the shell
            if(btnVal1 == 0):
                time.sleep(0.01)
                while(btnVal1 == 0):
                    btnVal1 = button1.value()
                    if(btnVal1 == 1):
                        count = count - 1
                        print(count)
                        if(count <= 0):
                            count = 0
                        
            btnVal2 = button2.value()        
            if(btnVal2 == 0):
                time.sleep(0.01)
                while(btnVal2 == 0):
                    btnVal2 = button2.value()
                    if(btnVal2 == 1):
                        count = count + 1
                        print(count)
                        if(count >= 4):
                            count = 4
            
            if(count == 0):
                func_color(0)
            elif(count == 1):
                func_color(1)
            elif(count == 2):
                func_color(2)
            elif(count == 3):
                func_color(3)
            elif(count == 4):
                func_color(4)

1.  **Test Result**

We can switch the color of the atmosphere lamp by clicking buttons 1 and 2.

### Project 7: Fan

1.  **Description**

In this project, we will learn how to make a small fan.

1.  **Component Knowledge**

The small fan uses a 130 DC motor and safe fan blades. You can use PWM output to control the fan speed.

![](media/33da52918e88862a94035d61a9050f2e.png)

1.  **Control Method**

Two pins are required to control the motor of the fan, one for INA and two for INB. The PWM value range is 0\~255. When the PWM output of the two pins is different, the fan can rotate.

| INA - INB \<= -45 | Rotate clockwise                                                                                                               |
|-------------------|--------------------------------------------------------------------------------------------------------------------------------|
| INA - INB \>= 45  | Rotate [anticlockwise](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;) |
| INA ==0, INB == 0 | Stop                                                                                                                           |

1.  **Control Pins**

| INA | 19 |
|-----|----|
| INB | 18 |

#### Project 7.1 Control the Fan

We can control the [anticlockwise](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;) and clockwise rotation speed of the fan.

**1. Test Code**

    from machine import Pin,PWM
    import time
    #Two pins of the motor
    INA =PWM(Pin(19,Pin.OUT),10000,0)#INA corresponds to IN+
    INB =PWM(Pin(18,Pin.OUT),10000,2)#INB corresponds to IN- 

    try:
        while True:
            #Counterclockwise 2s
            INA.duty(0) #The range of duty cycle is 0-1023
            INB.duty(700)
            time.sleep(2)
            #stop 1s
            INA.duty(0)
            INB.duty(0)
            time.sleep(1)
            #Turn clockwise for 2s
            INA.duty(600)
            INB.duty(0)
            time.sleep(2)
            #stop 1s
            INA.duty(0)
            INB.duty(0)
            time.sleep(1)
    except:
        INA.duty(0)
        INB.duty(0)
        INA.deinit()
        INB.deinit()

**2. Test Result**

The fan will rotate clockwise and [anticlockwise](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;) at different

speeds.

#### Project 7.2 Switch On or Off the Fan

One button switches the fan on and the other button controls the speed of the fan.

**1. Test Code**

    from machine import Pin,PWM
    import time
    #Two pins of the motor
    INA =PWM(Pin(19,Pin.OUT),10000,0)#INA corresponds to IN+
    INB =PWM(Pin(18,Pin.OUT),10000,2)#INB corresponds to IN-
    button1 = Pin(16, Pin.IN, Pin.PULL_UP)
    count = 0

    try:
        while True:
            btnVal1 = button1.value()  # Reads the value of button 1
            if(btnVal1 == 0):
                time.sleep(0.01)
                while(btnVal1 == 0):
                    btnVal1 = button1.value()
                    if(btnVal1 == 1):
                        count = count + 1
                        print(count)
            val = count % 2
            if(val == 1):
                INA.duty(0) #The range of duty cycle is 0-1023
                INB.duty(700)
            else:
                INA.duty(0)
                INB.duty(0)
    except:
        INA.duty(0)
        INB.duty(0)
        INA.deinit()
        INB.deinit()

**2. Test Result**

Click button 1, the fan starts to rotate, click button 2, the

speed can be adjusted(there are three different speeds), press the button 1 again, the fan stops.

### Project 8: LCD1602 Display

1.  **Description**

As we all know, screen is one of the best ways for people to interact with electronic devices.

1.  **Component Knowledge**

1602 is a line that can display 16 characters. There are two lines, which use IIC communication protocol.

![](media/066e093f1711ada67d3309ddc9bdc66e.png)

1.  **Control Pins**

| SDA | SDA |
|-----|-----|
| SCL | SCL |

#### Project 8.1 Display [Character](C:/Users/NINGMEI/AppData/Local/youdao/dict/Application/8.10.7.0/resultui/html/index.html#/javascript:;)s

1.  **Description**

We will use library file i2c_lcd.py and lcd_api.py, which should be saved in the ESP32 memory.

1.  **Operations**

Open the i2c_lcd.py and lcd_api.py

![](media/b5d74645d450d329aded48064bd599c8.png)

Select File \> save as \> MicroPython device

![](media/0b0e9857fb550f54a436bd92c64b00c7.png)

![](media/64b696646e34078f43d764690c3e3a48.png)

The saved name id i2c_lcd.py and lcd_api.py

![](media/c7a374c92ed24402abd0d8c479a7d132.png)

1.  **Test Code**

        from time import sleep_ms, ticks_ms 
        from machine import I2C, Pin 
        from i2c_lcd import I2cLcd 

        DEFAULT_I2C_ADDR = 0x27

        i2c = I2C(scl=Pin(22), sda=Pin(21), freq=400000) 
        lcd = I2cLcd(i2c, DEFAULT_I2C_ADDR, 2, 16)

        lcd.move_to(1, 0)
        lcd.putstr('Hello')
        lcd.move_to(1, 1)
        lcd.putstr('keyestudio')

        # The following line of code should be tested
        # using the REPL:

        # 1. To print a string to the LCD:
        #    lcd.putstr('Hello world')
        # 2. To clear the display:
        #lcd.clear()
        # 3. To control the cursor position:
        # lcd.move_to(2, 1)
        # 4. To show the cursor:
        # lcd.show_cursor()
        # 5. To hide the cursor:
        #lcd.hide_cursor()
        # 6. To set the cursor to blink:
        #lcd.blink_cursor_on()
        # 7. To stop the cursor on blinking:
        #lcd.blink_cursor_off()
        # 8. To hide the currently displayed character:
        #lcd.display_off()
        # 9. To show the currently hidden character:
        #lcd.display_on()
        # 10. To turn off the backlight:
        #lcd.backlight_off()
        # 11. To turn ON the backlight:
        #lcd.backlight_on()
        # 12. To print a single character:
        #lcd.putchar('x')
        # 13. To print a custom character:
        #happy_face = bytearray([0x00, 0x0A, 0x00, 0x04, 0x00, 0x11, 0x0E, 0x00])
        #lcd.custom_char(0, happy_face)
        #lcd.putchar(chr(0))

1.  **Test Result**

The first line of the LCD1602 shows hello and the second line shows keyestudio.

#### Project 8.2 Dangerous Gas Alarm

**1. Description**

When a gas sensor detects a high concentration of dangerous gas, the buzzer will sound an alarm and the display will show dangerous.

**2. Component Knowledge**

**MQ2 Smoke Sensor**: It is a gas leak monitoring device for homes and factories, which is suitable for liquefied gas, benzene, alkyl, alcohol, hydrogen as well as smoke detection. Our sensor leads to digital pin D and analog output pin A, which is connected to D as a digital sensor in this project .

![](media/4550c4935e6c08e595a1e8707b54b551.png)

**3. Control Pin**

| Gas Sensor | 23 |
|------------|----|

**4. Test Code**

    from time import sleep_ms, ticks_ms 
    from machine import I2C, Pin 
    from i2c_lcd import I2cLcd 

    DEFAULT_I2C_ADDR = 0x27

    i2c = I2C(scl=Pin(22), sda=Pin(21), freq=400000) 
    lcd = I2cLcd(i2c, DEFAULT_I2C_ADDR, 2, 16)

    from machine import Pin
    import time
    gas = Pin(23, Pin.IN, Pin.PULL_UP)

    while True:
        gasVal = gas.value()  # Reads the value of button 1
        print("gas =",gasVal)  #Print it out in the shell
        lcd.move_to(1, 1)
        lcd.putstr('val: {}'.format(gasVal))
        if(gasVal == 1):
            #lcd.clear()
            lcd.move_to(1, 0)
            lcd.putstr('Safety       ')
        else:
            lcd.move_to(1, 0)
            lcd.putstr('dangerous')
        time.sleep(0.1) #delay 0.1s

1.  **Test Result**

The screen displays "safety" in normal state. However, when the gas sensor detects some dangerous gases, such as carbon monoxide, at a certain concentration, the buzzer will sound an alarm and the screen displays "dangerous".

### Project 9: Temperature and Humidity Sensor

1.  **Component Knowledge**

Its communication mode is serial data and single bus. The temperature measurement range is -20 \~ +60℃, accuracy is ±2℃. However, the humidity range is 5 \~ 95%RH, the accuracy is ±5%RH.

![](media/0b9c44c3e4f3706638b9cf15871b861c.png)

1.  **Control Pin**

| Temperature and Humidity Sensor  | 17 |
|----------------------------------|----|

#### Project 9.1 Temperature and Humidity Tester

**1. Test Code**

    # Import machine, time and dht modules. 
    import machine
    import time
    import dht
    from time import sleep_ms, ticks_ms 
    from machine import I2C, Pin 
    from i2c_lcd import I2cLcd 

    #Associate DHT11 with Pin(17).
    DHT = dht.DHT11(machine.Pin(17))

    DEFAULT_I2C_ADDR = 0x27

    i2c = I2C(scl=Pin(22), sda=Pin(21), freq=400000) 
    lcd = I2cLcd(i2c, DEFAULT_I2C_ADDR, 2, 16)

    while True:
        DHT.measure() # Start DHT11 to measure data once.
    # Call the built-in function of DHT to obtain temperature
    # and humidity data and print them in “Shell”.
        print('temperature:',DHT.temperature(),'℃','humidity:',DHT.humidity(),'%')
        lcd.move_to(1, 0)
        lcd.putstr('T: {}'.format(DHT.temperature()))
        lcd.move_to(1, 1)
        lcd.putstr('H: {}'.format(DHT.humidity()))
        time.sleep_ms(1000)

**2. Test Result**

The LCD1602 displays the temperature (T = \*\* ° C) and humidity (H = \*\* %RH). When you breathe into the T/H sensor, you can see that the humidity rises.

### Project 10: RFID RC522 Module

1.  **Component Knowledge**

Radio frequency identification, the card reader is composed of a radio frequency module and a high-level magnetic field. The Tag transponder is a sensing device, which doesn’t contain a battery. It only contains tiny integrated circuit chips and media for storing data and antennas for receiving and transmitting signals.

To read the data in the tag, first put it into the reading range of the card reader. The reader will generate a magnetic field, which can produce electricity according to Lenz's law, then the RFID tag will supply power, thereby activating the device.

![](media/982ac6a9da0e8f55465ca5a969ac0dfe.png)

1.  **Control Pins**

Use IIC communication

| SDA | SDA |
|-----|-----|
| SCL | SCL |

#### Project 10.1 Open the Door

**1. Test Code**

![](media/03cab1a254dc41e5a07fda0a11daba59.png)

    from machine import Pin, PWM,I2C, Pin
    import time
    from mfrc522_i2c import mfrc522


    pwm = PWM(Pin(13))  
    pwm.freq(50)
    button1 = Pin(16, Pin.IN, Pin.PULL_UP)
    #i2c config
    addr = 0x28
    scl = 22
    sda = 21
        
    rc522 = mfrc522(scl, sda, addr)
    rc522.PCD_Init()
    rc522.ShowReaderDetails()            # Show details of PCD - MFRC522 Card Reader details

    data = 0

    while True:
        if rc522.PICC_IsNewCardPresent():
            #print("Is new card present!")
            if rc522.PICC_ReadCardSerial() == True:
                print("Card UID:")
                #print(rc522.uid.uidByte[0 : rc522.uid.size])
                for i in rc522.uid.uidByte[0 : rc522.uid.size]:
                    data = data + i
            print(data)
            if(data == 656):
                pwm.duty(128)
                print("open")
            else:
                print("error")
            data = 0
        btnVal1 = button1.value()
        if(btnVal1 == 0):
            pwm.duty(25)
            print("close")
        time.sleep(1)

**2. Test Result**

Close the provided card to the RFID induction area, the door will turn and open, and the shell shows "open". Click button 1 and the door turns and closes. However, when swiping another blue induction block, the shell shows "Error".

![](media/03fd569d64704a7e9705c1891f4d4856.png)

### Project 11: Morse Code

Morse code, also known as Morse password, is an on-again, off-again signal code that expresses different letters, numbers, and punctuation marks in different sequences. Now we use it as our password gate.

The Morse code corresponds to the following characters:

![](media/1a5e70c0d091e2617acbfc274827b4fd.png)

#### Project 11.1 Morse Code Open the Door

**1. Description**

We use ![](media/9491f7768f28ee4901e6fdb83632c27c.png)as the correct password. What’s more, there is a button library file OneButton, which is very simple to click, double click, long press and other functions. For Morse password, click is “.”, long press and release is “-”.

**2. Test Code**

    # Import machine, time and dht modules. 
    from machine import Pin, PWM
    from time import sleep_ms, ticks_ms 
    from machine import I2C, Pin 
    from i2c_lcd import I2cLcd 

    DEFAULT_I2C_ADDR = 0x27

    i2c = I2C(scl=Pin(22), sda=Pin(21), freq=400000) 
    lcd = I2cLcd(i2c, DEFAULT_I2C_ADDR, 2, 16)

    button1 = Pin(16, Pin.IN, Pin.PULL_UP)
    button2 = Pin(27, Pin.IN, Pin.PULL_UP)
    count = 0
    time_count = 0
    password = ""   #Enter password
    correct_password = "-.-"  #Correct password
    lcd.putstr("Enter password")
    pwm = PWM(Pin(13))  
    pwm.freq(50)

    while True:
        btnVal1 = button1.value()  # Read the value of button 1
        if(btnVal1 == 0):
            sleep_ms(10)
            while(btnVal1 == 0):
                time_count = time_count + 1  #Start counting the pressed time of the button
                sleep_ms(200)                #The time is 200ms cumulative
                btnVal1 = button1.value()
                if(btnVal1 == 1):
                    count = count + 1
                    print(count)
                    print(time_count)
                    if(time_count > 3):      #If the pressed time of the button is more than 200*3ms，add"-" to  password
                        lcd.clear()
                        #lcd.move_to(1, 1)
                        password = password + "-"
                    else:
                        lcd.clear()
                        password = password + "."  #Otherwise add "."
                    lcd.putstr('{}'.format(password)) 
                    time_count = 0
                    
        btnVal2 = button2.value()
        if(btnVal2 == 0):
            if(password == correct_password):  #If the password is correct
                lcd.clear()
                lcd.putstr("open")
                pwm.duty(128)  #Open the door
                password = ""  #Remove the password
                sleep_ms(1000)
            else:              #If the password is wrong
                lcd.clear()
                lcd.putstr("error")
                pwm.duty(25)  #Close the door
                sleep_ms(2000)
                lcd.clear()
                lcd.putstr("enter again")
                password = ""  #Remove the password

1.  **Test Result**

At first, the LCD1602 displays "Enter password", then click or long press button 1 to tap the password. If we input the correct password "-.-", then click button 2, the door will open, and the LCD1602 will display "open".

If other incorrect passwords are entered, the door will be closed and the LCD1602 will display error, which shows “enter again” 2s later.

### Project 12: WiFi

The easiest way to access the Internet is to use a WiFi to connect. The ESP32 main control board comes with a WiFi module, making our smart home accessible to the Internet easily.

![QQ图片20220112155539-2](media/f74baff97695aa2ee33a8c19370d2547.png)

#### Project 12.1 Smart Home

**1. Description**

We connect the smart home to a LAN, which is the WiFi in your home or the hot spot of your phone. After the connection is successful, an address will be assigned. We will print the assigned address in the shell.

**2. Test Code**

Note: ssiD and password in the code should be filled with your own WiFi name and password.

![](media/278cbdc272b5cc1a6461a7934eabe5c0.png)

    import time
    import network #Import network module

    #Enter correct router name and password
    ssidRouter     = 'ChinaNet-2.4G-0DF0' #Enter the router name
    passwordRouter = 'ChinaNet@233' #Enter the router password

    def STA_Setup(ssidRouter,passwordRouter):
        print("Setup start")
        sta_if = network.WLAN(network.STA_IF) #Set ESP32 in Station mode
        if not sta_if.isconnected():
            print('connecting to',ssidRouter)
    #Activate ESP32’s Station mode, initiate a connection request to the router
    #and enter the password to connect.
            sta_if.active(True)
            sta_if.connect(ssidRouter,passwordRouter)
    #Wait for ESP32 to connect to router until they connect to each other successfully.
            while not sta_if.isconnected():
                pass
    #Print the IP address assigned to ESP32 in “Shell”.
        print('Connected, IP address:', sta_if.ifconfig())
        print("Setup End")

    try:
        STA_Setup(ssidRouter,passwordRouter)
    except:
        sta_if.disconnect()

**3. Test Result**

If the WiFi is connected successfully, the serial monitor will print out the connected WiFi name and assigned IP address.

![](media/8c021cf89562d7ee27a6446f54be17bf.png)

## 7. Resources

Download code, libraries and more details, please refer to the following link:

https://fs.keyestudio.com/KS5009
